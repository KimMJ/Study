# 의존성 주입

## 의존성 관리

### 스프링의 의존성 관리 방법

* 객체의 생성과 의존관계를 컨테이너가 자동으로 관리한다.
* 이것이 IoC의 핵심 원리이다.
* 다음 두가지 형태로 지원
	1. Dependency Lookup
		* 컨테이너가 애플리케이션 운용에 필요한 객체를 생성하고, 클라이언트는 이 객체를 검색(Lookup)하여 사용하는 방식
	2. Dependency Injection
		* 대부분 사용하는 방법.
		* 객체 사이의 의존관계를 스프링 설정 파일에 등록된 정보를 바탕으로 컨테이너가 자동으로 처리해 준다.
		* 따라서 의존성을 바꾸고 싶을 때 프로그램 코드를 수정하지 않고 스프링 설정 파일 수정만으로 변경사항을 적용할 수 있어서 유지보수가 향상된다.
		* 컨테이너가 직접 객체들 사이에 의존관계를 처리하는 것.
		* 두가지로 분류
			1. Setter Injection
			2. Constructor Injection

### 의존성 관계

```
의존성 : 객체와 객체의 결합 관계
```

즉, 하나의 객체에서 다른 객체의 변수나 메소드를 이용해야 한다면 이용하려는 객체에 대한 객체 생성과 생성된 객체의 레퍼런스 정보가 필요.

## Constructor Injection

* 스프링 컨테이너는 기본적으로 매개 변수가 없는 기본 Default 생성자를 호출.
* 하지만 컨테이너가 기본 생성자 말고 매개변수를 가지는 다른 생성자를 호출하도록 설정 가능 -> 이 기능을 이용하여 Constructor Injection 처리
* 생성자의 매개변수로 의존관계에 있는 객체의 주소 정보를 전달할 수 있음.
* Constructor Injection을 위해서는 `<constructor-arg>` 엘리먼트를 추가하면 된다.
* 그리고 생성자 인자로 전달할 객체의 아이디를 `<constructor-arg>` 엘리먼트에 ref 속성으로 참조한다.
* 스프링 컨테이너는 기본적으로 bean 등록된 순서대로 객체를 생성하고, 모든 객체는 기본 생성자 호출을 원칙으로 한다. 하지만 필요에 따라 순서를 바꾸어 진행한다.

### 다중 변수 매핑

* 초기화 해야할 멤버변수가 여러 개이면, 여러 개 값을 한꺼번에 전달해야 한다.
* `<constructor-arg` 엘리먼트는 ref와 value속성을 사용하여 생성자 매개변수로 전달할 값을 지정할 수 있다.
* 이때 인자로 전달될 데이터가 `<bean>`으로 등록된 다른 객체일 때는 ref 속성을 이용하여 해당 객체의 아이디나 이름을 참조한다.
* 고정된 문자열이나 정수같은 기본형 데이터는 value속성을 사용한다.
* index 속성을 지원하여 어떤 값이 몇 번째 매개변수로 매핑되는지 지정할 수 있다. (0부터 시작)

#### 중요한 점은 자바 코드를 수정하지 않는다는 것!

## Setter Injection

* Setter 메소드를 호출하여 의존성 주입을 처리.
* Constructor Injection, Setter Injection 모두 멤버변수를 원하는 값으로 설정하는 것을 목적으로 하고 있고, 결과가 같으므로 둘 중 어느것을 사용하는 상관 없음.

### Setter Injection 기본

* 먼저 클래스에 Setter 메소드를 추가.
* Setter 메소드는 스프링 컨테이너가 자동으로 호출.
* 호출 시점은 `<bean>` 객체 생성 직후
* Setter Injection이 동장하려면 Setter Method 뿐만 아니라 Default Constructor도 반드시 필요.
* `<property>` 엘리먼트 사용.
* name 속성 값이 호출하고자 하는 메소드 이름. 즉, `<property name="speaker">`일 경우 setSpeaker()호출.

### p 네임스페이스 사용하기

* Setter Injection을 설정할 때 'p namespace'를 설정하면 좀 더 효율적으로 의존성 주입 가능.
* 'p namespace'는 별도의 schemaLocation이 없어서 네임스페이스만 선언하고 사용 가능.
* `xmlns:p="http://www.springframework.org/schema/p"`
* 이것을 설정했으면 다음과 같이 참조형 변수에 참조할 객체 할당 가능
* `p:변수명-ref="참조할 객체의 이름이나 아이디"`
* 기본형이나 문자형 변수에 직접 값을 설정할 수 있음
* `p:변수명="설정할 값"`

## Collection 객체 설정

Collection객체를 이용하여 데이터 집합을 사용해야 하는 경우에 컬랙션 객체를 의존성 주입하면 된다.
